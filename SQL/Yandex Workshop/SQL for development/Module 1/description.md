## I проект

- [ ] В первом проекте требуется создать БД, нормализовать её, наполнить данными и выполнить шесть заданий на выборку данных из базы.

## Этап 1. Создание и заполнение БД

Требуется создать базу данных, схемы, таблицы и заполнить их данными.

Пошаговая инструкция:
- Шаг 1. Создать БД с именем *sprint_1*.
- Шаг 2. Создать схему *raw_data* и таблицу *sales* для загрузки сырых данных в этой схеме.
- Шаг 3. Скачать и проанализировать исходный csv-файл.
- Шаг 4. Заполнить таблицу *sales* данными, используя команду *COPY* в менеджере БД.
- Шаг 5. Проанализировать сырые данные.
  Подумать:
    - какие данные повторяются и их стоит вынести в отдельные таблицы;
    - какие типы данных должны быть у каждого поля;
    - на какие поля стоит добавить ограничения (*CONSTRAINTS*);
    - какие поля могут содержать *NULL*, а где нужно добавить ограничение *NOT NULL*.
- Шаг 6. Создать схему *car_shop*, а в ней создать нормализованные таблицы (до третьей нормальной формы). Подумать, какие поля будут выступать первичными ключами, а какие внешними. У всех первичных ключей должен быть автоинкремент.
- Шаг 7. Выбрать наиболее подходящий формат данных для каждой колонки.
- Шаг 8. Заполнить все таблицы данными, c помощью команд *INSERT INTO … SELECT …*. Чтобы разбить столбец с маркой, моделью машины и её цветом, можно использовать разные способы.

## Этап 2. Создание выборок

После создания таблицы и заполнении её данными требуется выполнить задания на выборку данных для аналитики.

### Задание 1
- [ ] Требуется написать запрос, который выведет процент моделей машин, у которых нет параметра *gasoline_consumption*.

Формат итоговой таблицы:

| nulls_percentage_gasoline_consumption  |
| ------------- |
|  Число  |

### Задание 2
- [ ] Требуется написать запрос, который покажет название бренда и среднюю цену его автомобилей в разбивке по всем годам с учётом скидки. 

Итоговый результат отсортируйте по названию бренда и году в восходящем порядке. Среднюю цену округлите до второго знака после запятой.

Формат итоговой таблицы:

| brand_name  | year | price_avg  |
| ---- | ---- | ---- |
|  Audi  |  2015  |  Средняя цена  |
|  Audi  |  …………  |  Средняя цена  |
|  Audi  |  2023  |  Средняя цена  |
|  BMW  |  2015  |  Средняя цена  |
|  BMW  |  …………  |  Средняя цена  |
|  BMW  |  2023  |  Средняя цена  |
|  Hyundai  |  2015  |  Средняя цена  |
|  Hyundai  |  …………  |  Средняя цена  |
|  Hyundai  |  2023  |  Средняя цена  |

### Задание 3
Посчитайте среднюю цену всех автомобилей с разбивкой по месяцам в 2022 году с учётом скидки. Результат отсортируйте по месяцам в восходящем порядке. Среднюю цену округлите до второго знака после запятой.
Вот формат итоговой таблицы:
month	year	price_avg
1	2022	Средняя цена
2	2022	Средняя цена
3	2022	Средняя цена
…	2022	Средняя цена
12	2022	Средняя цена

### Задание 4
Используя функцию STRING_AGG, напишите запрос, который выведет список купленных машин у каждого пользователя через запятую. Пользователь может купить две одинаковые машины — это нормально. Название машины покажите полное, с названием бренда — например: Tesla Model 3. Отсортируйте по имени пользователя в восходящем порядке. Сортировка внутри самой строки с машинами не нужна.
Вот формат итоговой таблицы:
person	cars
Alexander Kozlov	Lada Vesta
John Doe	Audi A3, Lada Samara
Ivan Petrov	Audi S3

### Задание 5
Напишите запрос, который вернёт самую большую и самую маленькую цену продажи автомобиля с разбивкой по стране без учёта скидки. Цена в колонке price дана с учётом скидки.
Вот формат итоговой таблицы:
brand_origin	price_max	price_min
USA	Максимальная_цена	Минимальная_цена
Germany	Максимальная_цена	Минимальная_цена
South Korea	Максимальная_цена	Минимальная_цена
Russia	Максимальная_цена	Минимальная_цена

### Задание 6
Напишите запрос, который покажет количество всех пользователей из США. Это пользователи, у которых номер телефона начинается на +1.
Вот формат итоговой таблицы:
persons_from_usa_count
число
